apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: tekton-noop
  namespace: tektonci
  description: |
    Example CI Job that does nothing interesting.
spec:
  params:
    - name: message
      description: A message to log
      type: string
    - name: passorfail
      description: whether it should 'pass' or 'fail'
      type: string
      default: 'pass'
  resources:
    inputs:
      - name: source
        type: git
    outputs:
      - name: endtrigger
        type: cloudEvent
  steps:
  - name: noop
    image: busybox
    script: |
      #!/bin/sh
      set -ex
      echo "$(params.message)"
      echo
      sleep 120
      echo "Content of the repo:"
      ls $(resources.inputs.source.path)
      [[ "$(params.passorfail)" == "pass" ]]
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: tekton-fails-sometimes
  namespace: tektonci
  description: |
    Example CI Job that fails ~50% of the times
spec:
  params:
    - name: message
      description: A message to log
      type: string
  resources:
    inputs:
      - name: source
        type: git
    outputs:
      - name: endtrigger
        type: cloudEvent
  steps:
  - name: noop
    image: busybox
    script: |
      #!/bin/sh
      set -ex
      echo "$(params.message)"
      echo
      sleep 30
      echo "Content of the repo:"
      ls $(resources.inputs.source.path)
      exit $(( $(date +"%s") % 2 ))
---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: yamllint
  namespace: tektonci
  description: |
    Lint yamls
spec:
  params:
  - name: folders
    description: The folders to lint with yamllint
  resources:
    inputs:
      - name: source
        type: git
    outputs:
      - name: endtrigger
        type: cloudEvent
  steps:
  - name: lint
    image: gcr.io/tekton-releases/dogfooding/yamllint:latest
    script: |
      #!/bin/sh
      set -ex
      yamllint $(params.folders)
